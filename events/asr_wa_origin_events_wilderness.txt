namespace = asr_wa_wilderness

country_event = {
  id = asr_wa_wilderness.1
  hide_window = yes
  is_triggered_only = yes
  trigger = { is_wilderness_empire = yes }

  immediate = {
    give_technology = {
      tech = tech_terrestrial_sculpting
      message = no
    }
    # add_research_option = tech_ecological_adaptation
  }
}

country_event = {
  id = asr_wa_wilderness.100
  hide_window = yes
  is_triggered_only = yes
  trigger = { is_wilderness_empire = yes }

  immediate = {
    country_event = {
      id = asr_wa_wilderness.101
      days = 2
    }
  }
}

country_event = {
  id = asr_wa_wilderness.101
  hide_window = yes
  is_triggered_only = yes
  trigger = {
    is_wilderness_empire = yes
  }

  immediate = {
    every_owned_planet = {
      asr_wa_change_to_wilderness_districts = yes
      if = { # 多重起源Mod, 盖亚开兼容
        limit = { asr_wa_planet_is_wilderness_arcology = yes }
        asr_wa_change_to_wilderness_advanced_districts = yes
      }
    }
    country_event = {
      id = asr_wa_wilderness.102
      months = 1
    }
  }
}

country_event = {
  id = asr_wa_wilderness.102
  hide_window = yes
  is_triggered_only = yes
  trigger = {
    is_wilderness_empire = yes
  }

  immediate = {
    every_owned_planet = {
      if = {
        limit = {
          NOR = {
            has_building = building_colony_shelter_wilderness
            has_building = building_capital_wilderness
            has_building = building_major_capital_wilderness
            has_building = building_system_capital_wilderness
            has_building = building_imperial_capital_wilderness
          }
        }
        set_timed_planet_flag = {
          flag = ignore_ai_building_limitations
          days = 1
        }
        add_building = building_capital_wilderness
      }
    }
  }
}

# This = Country From = Species (post modify) FromFrom = Species (pre modify)
country_event = {
  id = asr_wa_wilderness.200
  hide_window = yes
  is_triggered_only = yes
  trigger = {
    is_wilderness_empire = yes
    has_tradition = tr_purity_finish
    any_owned_species = {
      OR = {
        has_trait = trait_wilderness
        is_archetype = PRESAPIENT
        is_archetype = BIOLOGICAL
        is_archetype = LITHOID
      }
    }
  }

  immediate = {
    # 更新所有物种, 这样就可以在事件给物种添加上特质时用这种方式刷新变量
    # from = { set_species_traits_purity_count_variable = yes }
    every_owned_species = {
      limit = {
        OR = {
          has_trait = trait_wilderness
          is_archetype = PRESAPIENT
          is_archetype = BIOLOGICAL
          is_archetype = LITHOID
        }
      }
      set_species_traits_purity_count_variable = yes
    }
  }
}

country_event = {
  id = asr_wa_wilderness.201
  hide_window = yes
  is_triggered_only = yes
  trigger = {
    is_wilderness_empire = yes
    has_tradition = tr_purity_finish
    any_owned_species = {
      OR = {
        has_trait = trait_wilderness
        is_archetype = PRESAPIENT
        is_archetype = BIOLOGICAL
        is_archetype = LITHOID
      }
      NOT = { is_variable_set = species_traits_purity_count }
    }
  }

  immediate = {
    every_owned_species = {
      limit = {
        OR = {
          has_trait = trait_wilderness
          is_archetype = PRESAPIENT
          is_archetype = BIOLOGICAL
          is_archetype = LITHOID
        }
        NOT = { is_variable_set = species_traits_purity_count }
      }
      set_species_traits_purity_count_variable = yes
    }
  }
}

# This = planet, From = country
planet_event = {
  id = asr_wa_wilderness.1000
  hide_window = yes
  is_triggered_only = yes
  trigger = {
    from = { is_wilderness_empire = yes }
    asr_wa_planet_is_wilderness_arcology = yes
  }

  immediate = {
    add_zone = {
      zone = zone_asr_wa_energy
      zone_slot = slot_gaia_rural_01
      district = district_asr_wa_cragland_01
      replace = no
    }
    add_zone = {
      zone = zone_asr_wa_mineral
      zone_slot = slot_gaia_rural_02
      district = district_asr_wa_cragland_02
      replace = no
    }
    add_zone = {
      zone = zone_asr_wa_food
      zone_slot = slot_gaia_rural_03
      district = district_asr_wa_cragland_03
      replace = no
    }
  }
}
